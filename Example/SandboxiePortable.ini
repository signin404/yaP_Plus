[General]
;主程序
application=App\SandMan.exe

;命令行
;commandline=-Portable

;工作目录
;workdir=Data

;临时文件
tempfile=Data

;多实例
;multiple=1

;崩溃清理等待
;单位:毫秒
crashwait=1000

;备份间隔
;单位:分
backuptime=10

;等待进程
;进程 :: 匹配 :: 路径
;匹配 = path
;waitprocess=Portable.exe

;前台进程
;foreground={EXENAME}

;挂起进程
suspend=chrome.exe
suspend=TrafficMonitor.exe
suspend=ListaryHelper64.exe
suspend=ListaryHookHelper32.exe
suspend=ListaryHookHelper64.exe
suspend=ListaryService.exe

[Before]
;运行前执行

;用户变量
;变量名 :: 变量值
;设置后可使用 "{Portable}" 引用
;主程序绝对路径 = {APPEXE}
;主程序基本名称 = {APPNAME}
;主程序完整名称 = {EXENAME}
;主程序工作目录 = {WORKDIR}
;主程序目录绝对路径 = {EXEPATH}
;启动器当前驱动器号 = {DRIVE}
;启动器目录绝对路径 = {YAPROOT}
;uservar=Local :: %LocalAppData%
;uservar=LocalLow :: %UserProfile%\AppData\LocalLow
;uservar=Roaming :: %AppData%
;uservar=Documents :: %UserProfile%\Documents
;uservar=ProgramData :: %ProgramData%
;uservar=SavedGames :: %UserProfile%\Saved Games
;uservar=PublicDocuments :: %Public%\Documents
uservar=Layers :: HKCU\SOFTWARE\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers
uservar=IFEO :: HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options
uservar=Certificates :: HKLM\SOFTWARE\Microsoft\SystemCertificates\AuthRoot\Certificates
uservar=Tracing :: HKLM\SOFTWARE\Microsoft\Tracing
uservar=RAMDISK :: Z:\TEMP\{APPNAME}

;环境变量
;变量名 :: 变量值 :: 类型
;类型 = user | system
;类型不写则为进程变量
;变量值为 "null" 则删除
;envvar=HomeDrive :: {DRIVE}
;envvar=HomePath :: {YAPROOT}\Data
;envvar=UserName :: {YAPROOT}\Data
;envvar=UserProfile :: {YAPROOT}\Data
;envvar=AppData :: {YAPROOT}\Data
;envvar=LocalAppData :: {YAPROOT}\Data
;envvar=ProgramData :: {YAPROOT}\Data
;envvar=AllUsersProfile :: {YAPROOT}\Data
envvar=Temp :: {YAPROOT}\Data\Temp
envvar=Tmp :: {YAPROOT}\Data\Temp

;运行文件
;路径 :: 等待 :: 隐藏 :: 命令行 :: 工作目录
;等待 = wait | null
;隐藏 = hide | null
;run=Other\Install.bat :: wait :: hide
;run=%ComSpec% :: wait :: hide :: /c PowerShell -ExecutionPolicy Bypass "{YAPROOT}\Other\Install.ps1"
;run=%ComSpec% :: wait :: hide :: /c PowerShell -Command Mount-DiskImage -ImagePath "{YAPROOT}\Other\Crack.iso"
;run=..\..\NVIDIAProfileInspector\App\nvidiaProfileInspector.exe :: wait :: hide :: -silent "{YAPROOT}\Other\Driver.nip"
;run=%ComSpec% :: null :: hide :: /c PowerShell -Command ForEach($PROCESS in GET-PROCESS chrome) {$PROCESS.ProcessorAffinity=1044480}
;run=%ComSpec% :: null :: hide :: /c nvidia-smi -lgc 2550,2775

;注册表导入
;regimport=Other\Install.reg

;注册或注销DLL
;注销 = :: unregister
;regdll=App\Portable.dll

;字符串替换
;文本 :: 查找 :: 替换 :: 用户变量
;删除 = null
;相同名称将覆盖现有的
;stringreplace={EXEPATH} :: \ :: \\ :: InstallDir

;创建防火墙规则
;名称 :: 方向 :: 操作 :: 路径
;方向 = in | out
;操作 = block | allow
;firewall={EXENAME} :: out :: block :: {APPEXE}
;firewall={EXENAME} :: in :: block :: {APPEXE}

;创建硬链接
;链接 :: 源 :: 遍历
;单层遍历 = file
;目录末尾必须用"\"表示
;hardlink=App\Portable.ini :: Data\Portable.ini

;创建符号链接
;链接 :: 源 :: 遍历
;单层遍历 = all | dir | file
;目录末尾必须用"\"表示
symlink=Sandbox\ :: Data\Sandbox\
symlink=Data\Sandbox\DefaultBox\ :: {RAMDISK}\DefaultBox\

;目录保存
;dir=Data\AppData\Local\NVIDIA\GLCache :: Data\GLCache
;dir=Data\AppData\Roaming\Portable :: Data\Portable
;dir={Roaming}\Portable :: Data\Portable

;文件保存
;目录末尾必须用"\"表示
file=App\addons.json :: Data\
file=App\Sandboxie.ini :: Data\
file=App\Sandboxie-Plus.ini :: Data\

;目录复制移动
;路径 :: 路径 :: 覆盖 :: 移动
;方向 = <- | ->
;移动 = move
;覆盖 = overwrite | no overwrite
;<-dir=Data\Portable :: Other\Default\Portable :: no overwrite

;文件复制移动
;路径 :: 路径 :: 覆盖 :: 移动
;方向 = <- | ->
;移动 = move
;覆盖 = overwrite | no overwrite
;<-file=Data\Portable.xml :: Other\Default\Portable.xml :: no overwrite

;注册表项保存
;HKU = HKEY_USERS
;HKCR = HKEY_CLASSES_ROOT
;HKCU = HKEY_CURRENT_USER
;HKLM = HKEY_LOCAL_MACHINE
;regkey=HKCU\SOFTWARE\Portable :: Data\Portable.reg

;注册表值保存
;regvalue=HKCU\SOFTWARE\Portable :: Data\Portable.reg

;目录还原
;(dir)={Roaming}\Portable

;文件还原
;(file)={Roaming}\Portable.ini

;注册表项还原
;(regkey)={IFEO}\{EXENAME}
(regkey)={Certificates}\E403A1DFC8F377E0F4AA43A83EE9EA079A1F55F2
;(regkey)=HKCU\SOFTWARE\Portable

;注册表值还原
;(regvalue)={Layers}\{APPEXE}
;(regvalue)=HKCU\SOFTWARE\Portable\Value

;创建目录
+dir={RAMDISK}\DefaultBox
;+dir=Data\AppData\Local
;+dir=Data\AppData\LocalLow
;+dir=Data\AppData\Roaming
+dir=Data\Temp
+dir=Data\Sandbox

;创建文件
;路径 :: 覆盖 :: 格式 :: 编码 :: 内容
;换行 = {LINEBREAK}
;覆盖 = overwrite | no overwrite
;格式 = win | unix | mac
;编码 = utf8 | utf8bom | utf16le | utf16be
+file=App\Sandboxie.ini :: no overwrite
+file=App\Sandboxie-Plus.ini :: no overwrite

;创建注册表项
;+regkey=HKCU\SOFTWARE\Portable

;创建注册表值
;项 :: 值 :: 类型 :: 值数据
;十进制 = REG_DWORD
;二进制 = REG_QWORD | REG_BINARY
;字符串 = REG_SZ | REG_MULTI_SZ | REG_EXPAND_SZ
;换行 = {LINEBREAK} | 二进制分隔符为逗号
;值数据不写则为空值 | 值为 "null" 则写入默认值
;+regvalue={Layers} :: {APPEXE} :: REG_SZ :: ~ HIGHDPIAWARE
;+regvalue={IFEO}\{EXENAME} :: FrontEndHeapDebugOptions :: REG_DWORD :: 8
;+regvalue=HKCU\SOFTWARE\Portable :: InstallDir :: REG_SZ :: {EXEPATH}

;写入INI
;路径 :: 节 :: 键 :: 值
;若值为 "null" 将删除键
;若节以 "--" 开头将删除节
;若节为 "null" 将写入没有节的键
;iniwrite={EXEPATH}\steam_emu.ini :: Settings :: Language :: schinese
;iniwrite=Data\Portable.ini :: Settings :: UpdateCheck :: 0

;文本替换
;路径 :: 查找 :: 替换 :: 模式
;删除 = {DELETE}
;换行 = {LINEBREAK}
;模式 = regex | regex/i
;replace=Data\Portable.ini :: English :: Chinese

;文本行替换
;路径 :: 查找行开头 :: 替换
;replaceline=Data\Portable.xml :: <InstallDir> :: <InstallDir>{EXEPATH}</InstallDir>

;设置属性
;默认为正常
;属性 = :: readonly, hidden, system
;attributes={Roaming}\Portable.ini

;备份目录
;源 :: 目标 :: 覆盖
;覆盖 = overwrite | no overwrite
;backupdir={Roaming}\Portable :: Data\#Backup\Portable

;备份文件
;源 :: 目标 :: 覆盖
;覆盖 = overwrite | no overwrite
;backupfile={Roaming}\Portable.ini :: Data\#Backup\Portable.ini

;延迟执行
;单位:毫秒
;delay=500

[After]
;退出后执行

;终止进程
;进程 :: 匹配 :: 路径
;通配符 = ? | *
;匹配值 = ppid | path
;killprocess=Portable.exe :: path

;运行文件
;路径 :: 等待 :: 隐藏 :: 命令行 :: 工作目录
;等待 = wait | null
;隐藏 = hide | null
;run=Other\Uninstall.bat :: wait :: hide
;run=%ComSpec% :: null :: hide :: /c schtasks /delete /tn "Portable" /f
;run=%ComSpec% :: wait :: hide :: /c sc.exe stop Portable & sc.exe delete Portable
;run=%ComSpec% :: wait :: hide :: /c PowerShell -ExecutionPolicy Bypass "{YAPROOT}\Other\Uninstall.ps1"
;run=%ComSpec% :: null :: hide :: /c PowerShell -Command Dismount-DiskImage -ImagePath "{YAPROOT}\Other\Crack.iso"
;run=%ComSpec% :: null :: hide :: /c PowerShell -Command ForEach($PROCESS in GET-PROCESS chrome) {$PROCESS.ProcessorAffinity=1048575}
;run=%ComSpec% :: null :: hide :: /c nvidia-smi -rgc

;注册表导入
;regimport=Other\Uninstall.reg

;注册或注销DLL
;注销 = :: unregister
;regdll=App\Portable.dll :: unregister

;目录复制移动
;路径 :: 路径 :: 覆盖 :: 移动
;方向 = <- | ->
;移动 = move
;覆盖 = overwrite | no overwrite
;->dir={Roaming}\Portable :: Data\Portable

;文件复制移动
;路径 :: 路径 :: 覆盖 :: 移动
;方向 = <- | ->
;移动 = move
;覆盖 = overwrite | no overwrite
;->file={Roaming}\Portable.ini :: Data\Portable.ini

;延迟自动清理
;restore=1

;文件删除
;通配符 = ? | *
-file={EXEPATH}\*.log
-file={EXEPATH}\*.dmp

;目录删除
;通配符 = ? | *
;仅为空时删除 = :: ifempty
-dir={RAMDISK}
;-dir=Data\AppData
-dir=Data\Temp
;-dir=Data\Microsoft
;-dir={Roaming}\Portable

;注册表值删除
;通配符 = ? | *
;-regvalue=HKCU\SOFTWARE\Portable :: Value

;注册表项删除
;通配符 = ? | *
;仅为空时删除 = :: ifempty
-regkey={Tracing}\{APPNAME}_*
-regkey=HKCU\SOFTWARE\Classes\PackagedCom\Package :: ifempty
-regkey=HKCU\SOFTWARE\Classes\PackagedCom :: ifempty
-regkey=HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\ImDiskApp
