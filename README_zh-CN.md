[English](./README.md) | 中文

[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/signin404/yaP_Plus)
[![zread](https://img.shields.io/badge/Ask_Zread-_.svg?style=flat&color=00b0aa&labelColor=000000&logo=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQuOTYxNTYgMS42MDAxSDIuMjQxNTZDMS44ODgxIDEuNjAwMSAxLjYwMTU2IDEuODg2NjQgMS42MDE1NiAyLjI0MDFWNC45NjAxQzEuNjAxNTYgNS4zMTM1NiAxLjg4ODEgNS42MDAxIDIuMjQxNTYgNS42MDAxSDQuOTYxNTZDNS4zMTUwMiA1LjYwMDEgNS42MDE1NiA1LjMxMzU2IDUuNjAxNTYgNC45NjAxVjIuMjQwMUM1LjYwMTU2IDEuODg2NjQgNS4zMTUwMiAxLjYwMDEgNC45NjE1NiAxLjYwMDFaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00Ljk2MTU2IDEwLjM5OTlIMi4yNDE1NkMxLjg4ODEgMTAuMzk5OSAxLjYwMTU2IDEwLjY4NjQgMS42MDE1NiAxMS4wMzk5VjEzLjc1OTlDMS42MDE1NiAxNC4xMTM0IDEuODg4MSAxNC4zOTk5IDIuMjQxNTYgMTQuMzk5OUg0Ljk2MTU2QzUuMzE1MDIgMTQuMzk5OSA1LjYwMTU2IDE0LjExMzQgNS42MDE1NiAxMy43NTk5VjExLjAzOTlDNS42MDE1NiAxMC42ODY0IDUuMzE1MDIgMTAuMzk5OSA0Ljk2MTU2IDEwLjM5OTlaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik0xMy43NTg0IDEuNjAwMUgxMS4wMzg0QzEwLjY4NSAxLjYwMDEgMTAuMzk4NCAxLjg4NjY0IDEwLjM5ODQgMi4yNDAxVjQuOTYwMUMxMC4zOTg0IDUuMzEzNTYgMTAuNjg1IDUuNjAwMSAxMS4wMzg0IDUuNjAwMUgxMy43NTg0QzE0LjExMTkgNS42MDAxIDE0LjM5ODQgNS4zMTM1NiAxNC4zOTg0IDQuOTYwMVYyLjI0MDFDMTQuMzk4NCAxLjg4NjY0IDE0LjExMTkgMS42MDAxIDEzLjc1ODQgMS42MDAxWiIgZmlsbD0iI2ZmZiIvPgo8cGF0aCBkPSJNNCAxMkwxMiA0TDQgMTJaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00IDEyTDEyIDQiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8L3N2Zz4K&logoColor=ffffff)](https://zread.ai/signin404/yaP_Plus)

# yaP Plus
[yaP](https://yap.rolandtoth.hu) (yet another Portablizer) 的重新实现

复制粘贴即可制作便携软件

[快速教程](https://github.com/signin404/yaP_Plus/discussions/50)

## 功能
- [x] 目录/文件保存
- [x] 目录/文件删除
- [x] 目录/文件还原
- [x] 目录/文件复制或移动
- [x] 注册表项/值保存
- [x] 注册表项/值删除
- [x] 注册表项/值还原
- [x] 创建目录/文件
- [x] 创建注册表项/值
- [x] 创建符号链接
- [x] 写入INI
- [x] 文本替换
- [x] 文本行替换
- [x] 运行文件
- [x] 终止进程
- [x] 多实例运行
- [x] 注册表导入
- [x] 注册或注销DLL
- [x] 设置目录/文件属性
- [x] 设置命令行
- [x] 设置工作目录
- [x] 设置环境/用户变量
- [x] 环境/用户变量字符串替换
- [x] 延迟执行
- [x] 延迟自动清理

* Plus
- [x] Unicode支持
- [x] 等待进程
- [x] 定时备份
- [x] 创建硬链接
- [x] 创建防火墙规则
- [x] 隐藏控制台程序窗口
- [x] 检测前台并挂起后台
- [x] 文件写入格式编码检测
- [x] 异常退出解决方案
- [x] 硬链接完整目录遍历
- [x] 硬/符号链接单层目录遍历
- [x] 检查父进程或路径并终止进程
- [x] 遍历子目录并删除文件/目录
- [x] (实验性) 挂钩重定向文件操作
- [x] (实验性) 挂钩伪造系统语言
- [x] (实验性) 挂钩伪造系统时间
- [x] (实验性) 挂钩伪造卷序列号
- [x] (实验性) 挂钩虚拟光驱
- [x] (实验性) 挂钩阻止联网
- [x] (实验性) 挂钩替换字体
- [x] (实验性) 注入第三方DLL

## 未移植功能
* !admin
* !dotnet
* !java
* !online
* !os
* clip
* ->regkey
* ->regvalue
* date
* iniread
* message
* nowait
* quit
* regexport
* regmerge
* systemrefresh

## 便携化方案对比

### 挂钩

*   **兼容性:** 低
*   **性能损耗:** 低
*   **隔离程度:** 中
*   **核心原理:** 通过挂钩系统 API 接口 实现文件或注册表操作的重定向
*   **优点:**
    *   性能损耗可忽略不计
*   **缺点:**
    *   软件越复杂或挂钩越多 冲突概率呈指数级增高
    *   对于不兼容的软件或插件 需要进行针对性的修复
    *   持续维护的工作量巨大

### 启动器

*   **兼容性:** 高
*   **性能损耗:** 无
*   **隔离程度:** 无
*   **核心原理:** 运行前写入配置 退出后删除或还原
*   **优点:**
    *   除了少数需要加载驱动的软件 几乎是通用方案
*   **缺点:**
    *   不适合行为不良的软件
    *   需要加载驱动的软件可能不适用
    *   如果软件不支持符号链接且配置文件很大 会导致大量写入
*   **使用此方案的软件:**
    *   [PortableApps.com Launcher](https://portableapps.com/apps/development/portableapps.com_launcher)
    *   [PortableApps Compiler & Management](https://github.com/daemondevin/pac-man)
    *   [X-Launcher](https://www.winpenpack.com/en/download.php?view.15) | [x64](https://www.portablefreeware.com/index.php?id=3134)
    *   [AutoRun LWMenu](https://github.com/lwcorp/lwmenu)
    *   [PortableXE](https://github.com/LMLK-seal/PortableXE)

### 虚拟化

*   **兼容性:** 中
*   **性能损耗:** 高
*   **隔离程度:** 高
*   **核心原理:** 创建一个虚拟化容器让软件在其中运行 与真实系统隔离
*   **优点:**
    *   适合行为不良、轻量级且不需要高性能的软件
*   **缺点:**
    *   **打包与体积:** 需要先将软件的所有文件打包 运行时再释放 导致文件体积翻倍
    *   **维护不便:** 安装或卸载游戏模组等插件 都需要对整个软件包重新打包
    *   **兼容性问题:** 需要挂钩的游戏插件可能无法在虚拟化环境中正常工作
    *   **性能瓶颈:** 虚拟化转译带来的性能损耗不可忽视 因此**不适合游戏或对性能要求高的软件**
*   **使用此方案的软件:**
    *   [Turbo Studio](https://turbo.net/studio)
    *   VMware ThinApp
    *   [Enigma Virtual Box](https://enigmaprotector.com/en/aboutvb.html)

### 自解压文件

*   **兼容性:** 高
*   **性能损耗:** 无
*   **隔离程度:** 无
*   **核心原理:** 将软件和配置释放到临时目录(%TEMP%)后运行 退出后删除
*   **优点:**
    *   制作简单 只需将软件和配置直接打包即可
*   **缺点:**
    *   无法处理注册表
    *   运行时更改的软件配置无法被保存
    *   每次运行都需要重新释放
*   **使用此方案的软件:**
    *   [PortableR](https://github.com/Shuunen/portabler)
    *   [单文件制作工具](http://wuyou.net/forum.php?mod=viewthread&tid=437991)
